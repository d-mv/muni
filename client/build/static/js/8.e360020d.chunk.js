(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{103:function(e,t,a){"use strict";var n=a(13),l=a(33),o=a(21),c=a(0),i=a.n(c),r=a(104),s=a.n(r),u=function(e){return i.a.createElement("h1",{className:"rtl"===e.direction?s.a.titleR:s.a.title},e.title)},d=a(8),p=a(105),m=a.n(p),h=a(6),b=a(106),f=a.n(b),v=Object(d.b)(function(e){return{language:e.language,type:e.type}},{})(function(e){var t=e.language,a=t.direction,c=t.text,r=f.a[Object(n.a)("header",a)],s=f.a[Object(n.a)("headerDesc",a)],u=f.a[Object(n.a)("title",a)];return i.a.createElement("div",{className:f.a.content},i.a.createElement("section",{className:r},i.a.createElement(l.a,{mode:"minimal",action:e.cancel},Object(o.j)("white")),i.a.createElement("div",{className:u},c["help.mycity"]),i.a.createElement(l.a,{mode:"minimal"})),i.a.createElement("section",{className:s},i.a.createElement("div",null,c["help.button.help"])),i.a.createElement("section",{className:f.a.pinned},i.a.createElement("div",null,c["help.post.pinned"])),i.a.createElement("section",{className:f.a.card},i.a.createElement("div",{className:f.a.photo},c["help.post.photo"]),i.a.createElement("div",{className:f.a.category},c["help.post.category"]),i.a.createElement("div",{className:f.a.title},c["help.post.title"]),i.a.createElement("div",{className:f.a.lineThree},c["help.post.age"])),i.a.createElement("section",null,i.a.createElement("div",{className:f.a.voteButtonText},c["muni"===e.type?"help.new.muni":"help.new"])),i.a.createElement("section",null,i.a.createElement("div",{className:f.a.navLeft},c["help.navigation"]),i.a.createElement("div",{className:f.a.navRight},c["help.navigation"])))}),_=Object(d.b)(function(e){return{module:e.module,language:e.language,help:e.help}},{showHelp:h.showHelp})(function(e){var t=e.language.direction,a=Object(n.a)("help-content",t),l=function(){e.showHelp(!e.help)},o=i.a.createElement("div",{className:a});switch(e.module){case"post":break;case"home":o=i.a.createElement(v,{cancel:l})}return i.a.createElement("div",{onClick:function(){return l()},className:"help"},o)});t.a=Object(d.b)(function(e){return{language:e.language,user:e.auth.user,help:e.help,module:e.module}},{showHelp:h.showHelp})(function(e){var t=e.language.direction,a=e.name,r=e.user,s=e.module,d=function(e,a){var l=a?m.a.icon:m.a[Object(n.a)("icon",t)];return i.a.createElement("div",{className:l},e)};Object(c.useEffect)(function(){r.settings.help&&e.showHelp(!0)},[]);var p=e.left?d(e.left.icon,e.left.noRtl):"home"===s?d(Object(o.j)("muni"===e.user.type?"secondary":"primary"),!0):i.a.createElement("div",null),h=e.right?d(e.right.icon,e.right.noRtl):i.a.createElement("div",null);return i.a.createElement("header",{className:m.a[Object(n.a)("plank",t)]},i.a.createElement(l.a,{mode:"minimal",action:function(){e.left?e.left.action():"home"===s&&e.showHelp(!e.help)}},p),i.a.createElement(u,{title:a,direction:t}),i.a.createElement(l.a,{mode:"minimal",action:function(){e.right&&e.right.action()}},h),e.help?i.a.createElement(_,null):null)})},104:function(e,t,a){e.exports={title:"Title_title__3-ab1",titleR:"Title_titleR__1AdDW"}},105:function(e,t,a){e.exports={plank:"Header_plank__1Xkcj",plankRTL:"Header_plankRTL__22swp",icon:"Header_icon__1KqqL",iconRTL:"Header_iconRTL__2ufUE"}},106:function(e,t,a){e.exports={content:"style_content__2T40g",central:"style_central__ADLjj",header:"style_header__tQ9Sx",headerRTL:"style_headerRTL__2kFRT",icon:"style_icon__1YFTz",iconRTL:"style_iconRTL__3HH5-",title:"style_title__1WHmK",titleRTL:"style_titleRTL__vpycB",headerDesc:"style_headerDesc__3ANCb",headerDescRTL:"style_headerDescRTL__3knRN",pinned:"style_pinned__Kl-fS",card:"style_card__1D5C-",photo:"style_photo__2fnix",category:"style_category__24IMX",lineThree:"style_lineThree__NkwpN",voteButtonText:"style_voteButtonText__2_n0m",navLeft:"style_navLeft__bzWVA",navRight:"style_navRight__k7-Uq"}},111:function(e,t,a){"use strict";var n=a(0),l=a.n(n),o=a(8),c=a(112),i=a.n(c);t.a=Object(o.b)(function(e){return{language:e.language}},{})(function(e){var t=e.language.text;return l.a.createElement("button",{className:i.a.vote},l.a.createElement("div",{className:i.a.inner},l.a.createElement("span",null,t["card.button.vote"])))})},112:function(e,t,a){e.exports={vote:"VoteButton_vote__lXrZs",inner:"VoteButton_inner__2gQwD"}},136:function(e,t,a){"use strict";var n=a(0),l=a.n(n),o=a(137),c=a.n(o);t.a=function(e){var t=c.a.block;return e.border?t=c.a.border:e.rectangle&&(t=c.a.borderRectangle),l.a.createElement("div",{className:t},e.children)}},137:function(e,t,a){e.exports={block:"Block_block__25D3U",border:"Block_border__3jZ4R",borderRectangle:"Block_borderRectangle__bDkgw"}},160:function(e,t,a){e.exports={tag:"ReplyTag_tag__2Bq_K",arrow:"ReplyTag_arrow__1ACvA"}},172:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(5),c=a(46),i=a(22),r=a(8),s=a(108),u=a(21),d=a(6),p=a(14),m=a(111),h=a(103),b=a(128),f=a(130),v=a(125),_=a(134),y=a.n(_),g=a(13),E=a(33),j=a(9),O=a(4),w=a(160),x=a.n(w),N=function(e){return l.a.createElement("div",{className:x.a.tag},l.a.createElement("p",null,e.text),l.a.createElement("div",{className:x.a.arrow},Object(u.f)("white")))},k=Object(r.b)(function(e){return{language:e.language,locations:e.locations,posts:e.posts,post:e.post,mode:e.mode,prevModule:e.prevModule,token:e.token,auth:e.auth,categories:e.categories}},{vote:d.vote,updatePost:p.j,setModule:d.setModule,fetchData:d.fetchData,getPosts:p.e,deletePost:p.c,showPost:p.h,votePost:p.k})(function(e){var t=e.categories,a=e.auth,r=e.locations,d=e.post,p=a.user,_=e.language,w=_.direction,x=_.text,k=_.short,R=Object(n.useState)(!1),T=Object(i.a)(R,2),P=T[0],L=T[1],C=Object(n.useState)(!1),S=Object(i.a)(C,2),M=S[0],B=S[1],D=Object(n.useState)(!1),H=Object(i.a)(D,2),A=H[0],U=H[1],q=Object(n.useState)(!1),V=Object(i.a)(q,2),K=V[0],F=V[1],W=l.a.createRef(),X=e.posts.filter(function(t){return t._id===e.post._id})[0],z=Object(n.useState)(!1),J=Object(i.a)(z,2),Q=J[0],Z=J[1],I=Object(n.useState)(!1),Y=Object(i.a)(I,2),G=Y[0],$=Y[1],ee=Object(n.useState)(!1),te=Object(i.a)(ee,2),ae=te[0],ne=te[1],le=Object(n.useState)(!1),oe=Object(i.a)(le,2),ce=oe[0],ie=oe[1],re=Object(n.useState)(!1),se=Object(i.a)(re,2),ue=se[0],de=se[1],pe=Object(n.useState)(!1),me=Object(i.a)(pe,2),he=me[0],be=me[1],fe=r.filter(function(e){return e._id===p.location})[0],ve=P?y.a.text:y.a.textClosed,_e=1===d.votes.length?x["post.voter"]:x["post.voters"],ye=Object(s.a)(t,k,d.category),ge={more:x["post.show-more"],less:x["post.show-less"]},Ee=d.votes.includes(e.auth.user._id),je=d.createdBy===e.auth.user._id,Oe="muni"===a.user.type;Object(n.useEffect)(function(){console.log("posts changed"),e.showPost(e.posts.filter(function(t){return t._id===e.post._id})[0])},[e.posts]);var we=!1;d.reply.up||d.reply.down?d.reply.up.length>0&&d.reply.down.length>0?we=[].concat(Object(c.a)(d.reply.up),Object(c.a)(d.reply.down)).includes(e.auth.user._id):d.reply.up.length>0?we=d.reply.up.includes(e.auth.user._id):d.reply.down.length>0&&(we=d.reply.down.includes(e.auth.user._id)):we=!0;var xe=function(){F(!K)},Ne=function(){ne(!ae)},ke=function(){$(!G)},Re=function(){ie(!ce)},Te=function(){de(!ue)},Pe=function(){be(!he)},Le=function(t){e.showPost({reply:{text:t.target.value}})},Ce=function(t){Object(O.a)({text:"submitUpdatePost:",emph:t||"",type:"positive"}),be(!1),ie(!1),F(!1),t?(Z(!1),ne(!1),"attention"===t?e.showPost(X):e.updatePost(d)):e.updatePost(d)},Se=function(){U(!A),setTimeout(function(){U(!A)},2e3),e.votePost(d._id)},Me=function(t){console.log("object"),Object(O.a)({text:"handleReplyVoting:",emph:t.toString(),type:"positive"});var a=d.reply.up,n=d.reply.down;t?a.push(e.auth.user._id):n.push(e.auth.user._id);var l=Object(o.a)({},d.reply,{reply:Object(o.a)({},d.reply,{up:a,down:n})});e.updatePost(Object(o.a)({},d,{reply:l}))},Be=x["post.age"],De=l.a.createElement(f.g,{date:d.createdAt,daysText:Be,direction:w,votes:d.votes.length,voterText:_e}),He=A?l.a.createElement(f.d,{close:Se,text:x["vote.thanks"]}):null,Ae=Ee||je||Oe?null:l.a.createElement("div",{className:y.a.voteButton,onClick:function(){return Se()}},l.a.createElement(m.a,null));d.votes.includes(e.auth.user._id)&&(Ae=l.a.createElement(f.l,{text:x["post.voted"],direction:w}));var Ue,qe="",Ve="",Ke=Oe&&!d.reply.text?l.a.createElement(f.f,{action:xe}):null;if(d.reply){var Fe=function(e,t){var a=e.up?e.up.length:0,n=e.down?e.down.length:0,l="secondary";return a<n&&(l="attention"),a===n&&(l="white"),{replyCardStyle:function(e,t,a){var n=e+t[0].toUpperCase()+t.slice(1);return a&&(n=n+a[0].toUpperCase()+a.slice(1)),n}("card",l,t?"open":"closed"),replyCardColor:l}}(d.reply,M),We=Fe.replyCardStyle,Xe=Fe.replyCardColor;d.reply.text&&!we?Ve=l.a.createElement("div",{className:y.a[Object(g.a)("thumbsContainer",w)]},l.a.createElement("div",{onClick:function(e){return Me(!0)}},Object(u.f)("white")),l.a.createElement("div",{onClick:function(e){return Me(!1)}},Object(u.f)("white"))):we&&(Ve=l.a.createElement(f.l,{text:x["post.voted"],direction:w}));var ze=l.a.createElement(f.i,{replies:{up:d.reply.up,down:d.reply.down}}),Je=null,Qe=null,Ze=null;Oe&&(Je=ce?l.a.createElement("div",{className:y.a[Object(g.a)("replyEditButtons",w)]},l.a.createElement(E.a,{mode:"secondary",title:x["muni-reply.edit"],action:Pe}),l.a.createElement(E.a,{mode:"attention",title:x["muni-reply.delete"],actionMessage:Te})):null,Qe=ue?l.a.createElement(f.c,{close:Te,action:function(t){if(Object(O.a)({text:"submitDeletePost:",emph:t,type:"positive"}),"primary"===t){var a=Object(o.a)({},d,{reply:{}});e.showPost(a),e.updatePost(a)}ie(!1)},text:x["muni-reply.delete.text"]}):null,Ze=he?l.a.createElement(f.c,{close:Pe,action:Ce,text:x["muni-reply.edit.text"]},l.a.createElement("div",{className:"section"},l.a.createElement("input",{autoFocus:!0,type:"text",name:"reply",value:d.reply.text,onChange:function(e){return Le(e)},placeholder:x["muni.post.prompt.text"],required:!0}))):null),qe=d.reply.text?l.a.createElement("div",{ref:W,id:"replyRef",className:y.a[We]},l.a.createElement("div",{className:y.a[Object(g.a)("replyTitleLine",w)]},ze,l.a.createElement("span",{className:y.a.replyCardTitle},x["munireply.title"])),l.a.createElement("div",{className:y.a.replyMessage},d.reply.text),d.reply.text.length>50?l.a.createElement(f.j,{color:"white"===Xe?"primary":"white",title:ge,direction:w,opened:M,action:B}):null,Je,Qe,Ze):null,Oe&&(Ve=null)}var Ie=G?l.a.createElement(f.a,{text:x["post.delete.confirm"],close:ke,action:function(t){Object(O.a)({text:"submitDeletePost:",emph:t,type:"positive"}),"secondary"===t&&(e.deletePost(d._id),e.setModule(e.prevModule))},direction:w}):null;Ue=K?l.a.createElement(b.a,{disabled:!0,close:xe},l.a.createElement(f.e,{label:x["newreply.label"],value:d.reply.text,placeholder:x["newreply.placeholder"],action:Le,direction:w,submit:Ce,submitText:x["login.button.submit"]})):null;var Ye=ae?l.a.createElement("div",null,l.a.createElement(f.a,{text:x["post.update.confirm"],close:Ne,action:Ce,direction:w})):null,Ge=Q?l.a.createElement("div",{className:y.a.deleteButton},l.a.createElement(E.a,{mode:"attention",action:ke},x["post.delete.button"])):null,$e=je||Oe?{right:{icon:Object(u.i)(Oe?"secondary":"primary"),action:Oe?Re:function(){Z(!Q)},noRtl:!0}}:null;(Q||ce)&&($e={right:{icon:Object(u.g)(ce?"secondary":"primary"),action:ce?Re:Ne,noRtl:!0}});var et=Object(o.a)({name:fe.name[p.settings.language]},$e,{left:{icon:Object(u.f)(Oe?"secondary":"primary"),action:function(){e.showPost(Object(o.a)({show:!1},j.b)),e.setModule(e.prevModule)}}});return l.a.createElement("div",{className:y.a.container},l.a.createElement(h.a,et),l.a.createElement("div",{className:y.a.wrapper},l.a.createElement("div",{"data-testid":"post__view",id:d._id,className:y.a.post},d.reply.text?l.a.createElement(N,{text:x["post.reply.tag"]}):null,l.a.createElement(f.k,{category:ye,title:d.title,numbersLine:De}),l.a.createElement(f.h,{src:d.photo,edit:Q,actions:{set:function(t){e.showPost({photo:t})},remove:function(){e.showPost({photo:""})}}}),l.a.createElement(f.b,{primary:!0,text:d.link,direction:w,edit:Q,actions:{set:function(t){e.showPost({link:t})},remove:function(){e.showPost({link:""})}},editText:{message:x["post.link.edit"],confirm:x.confirm,cancel:x.cancel,label:x["new.field.link.label"],placeholder:x["new.field.link.prompt"]}}),l.a.createElement("div",{className:ve},l.a.createElement(v.a,{step:!0,title:x["post.problem"],text:d.problem,direction:w}),d.solution?l.a.createElement(v.a,{back:!0,title:x["post.solution"],text:d.solution,direction:w}):null),l.a.createElement(f.j,{color:"primary",title:ge,direction:w,opened:P,action:L})),l.a.createElement("div",{className:y.a.voted},Ae),He,Ke,Ue,qe,d.reply.text?l.a.createElement("div",{className:y.a.replyVoted},Ve):null,Ge,Ie,Ye))}),R=a(10),T=a.n(R),P=a(136),L=a(102),C=Object(r.b)(function(e){return{auth:e.auth,language:e.language,locations:e.locations,prevModule:e.prevModule,post:e.news.filter(function(t){return t._id===e.post._id})[0]}},{setModule:d.setModule,getNews:p.d})(function(e){var t=e.language,a=t.direction,c=t.text,r=e.auth.user,s=e.locations.filter(function(e){return e._id===r.location})[0],d=Object(n.useState)(e.post),p=Object(i.a)(d,2),m=p[0],b=p[1],_=Object(n.useState)(!1),g=Object(i.a)(_,2),j=g[0],O=g[1],w=Object(n.useState)(!1),x=Object(i.a)(w,2),N=x[0],k=x[1],R=Object(n.useState)(!1),C=Object(i.a)(R,2),S=C[0],M=C[1],B="muni"===r.type;console.log(m.title);var D=function(){M(!S)},H=function(){O(!j)},A=function(){k(!N)},U=S?l.a.createElement("div",{className:y.a.deleteButton},l.a.createElement(E.a,{mode:"attention",action:H},c["post.delete.button"])):null,q=N?l.a.createElement("div",null,l.a.createElement(f.a,{text:c["post.update.confirm"],close:A,action:function(t){if("attention"===t)D(),b(e.post),A();else{var a="/muni/".concat(r.location);T.a.patch(a,Object(o.a)({},m)).then(function(t){D(),e.getNews(r.location)}).catch(function(e){console.log(e)})}},direction:a})):null,V=j?l.a.createElement(f.a,{text:c["post.delete.confirm"],close:H,action:function(t){if("secondary"===t){var a="/muni/".concat(r.location);T.a.put(a,{post:m._id}).then(function(t){D(),e.getNews(r.location)}).catch(function(e){console.log(e)})}},direction:a}):null,K=c["post.age"],F=l.a.createElement(f.g,{date:m.createdAt,daysText:K,direction:a}),W=B?{right:{icon:Object(u.i)("secondary"),action:D,noRtl:!0}}:null;S&&(W={right:{icon:Object(u.g)("secondary"),action:A,noRtl:!0}});var X=Object(o.a)({name:s.name[r.settings.language]},W,{left:{icon:Object(u.f)(B?"secondary":"primary"),action:function(){e.setModule(e.prevModule)}}});return console.log(s),l.a.createElement(L.a,{header:!0},l.a.createElement(h.a,X),l.a.createElement("div",{className:y.a.wrapper},l.a.createElement("div",{"data-testid":"post__view",id:m._id,className:y.a.post},l.a.createElement(f.k,{muni:!0,title:m.title,numbersLine:F}),l.a.createElement(f.h,{src:m.photo,edit:S,actions:{set:function(e){b(Object(o.a)({},m,{photo:e}))},remove:function(){b(Object(o.a)({},m,{photo:""}))}}}),l.a.createElement(P.a,null,l.a.createElement(f.b,{primary:!0,text:m.link,direction:a,edit:S,actions:{set:function(e){b(Object(o.a)({},m,{link:e}))},remove:function(){b(Object(o.a)({},m,{link:""}))}},editText:{message:c["post.link.edit"],confirm:c.confirm,cancel:c.cancel,label:c["new.field.link.label"],placeholder:c["new.field.link.prompt"]}})),l.a.createElement(v.a,{muni:!0,text:m.text,direction:a,edit:S,action:function(e){b(Object(o.a)({},m,{text:e}))}}))),U,V,q)}),S=a(42);t.default=function(e){return l.a.createElement(S.a,null,e.news?l.a.createElement(C,null):l.a.createElement(k,null))}}}]);
//# sourceMappingURL=8.e360020d.chunk.js.map