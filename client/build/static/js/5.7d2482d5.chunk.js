(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{119:function(e,t,a){"use strict";var n=a(0),o=a.n(n),c=a(120),l=a.n(c);t.a=function(e){var t=l.a.block;return e.border?t=l.a.border:e.rectangle&&(t=l.a.borderRectangle),o.a.createElement("div",{className:t},e.children)}},120:function(e,t,a){e.exports={block:"Block_block__25D3U",border:"Block_border__3jZ4R",borderRectangle:"Block_borderRectangle__bDkgw"}},153:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),c=a(7),l=a(1);function i(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var r=a(12),s=a(6),u=a.n(s),d=a(93),m=a(16),p=a(3),f=a(23),b=a(96),g=a(87),v=a(112),h=a(114),_=a(109),y=a(86),E=a(117),j=a.n(E),O=a(10),x=a(27),w=Object(c.b)(function(e){return{language:e.language,location:e.locationData,post:e.posts.filter(function(t){return t._id===e.post._id})[0],mode:e.mode,prevModule:e.prevModule,token:e.token}},{vote:p.o,updatePost:f.d,setModule:p.l,fetchData:p.b,getPosts:p.d,deletePost:f.a,showPost:f.b})(function(e){var t=e.location.categories,a=e.language,c=a.direction,s=a.text,p=a.short,f=Object(n.useState)(!1),E=Object(r.a)(f,2),w=E[0],N=E[1],k=Object(n.useState)(!1),T=Object(r.a)(k,2),R=T[0],S=T[1],L=Object(n.useState)(!1),D=Object(r.a)(L,2),M=D[0],C=D[1],B=Object(n.useState)(e.post.reply.text),P=Object(r.a)(B,2),H=P[0],A=P[1],J=Object(n.useState)(!1),U=Object(r.a)(J,2),q=U[0],V=U[1],F=Object(n.useState)(e.post),K=Object(r.a)(F,2),W=K[0],X=K[1],z=Object(n.useState)(!1),I=Object(r.a)(z,2),Q=I[0],Z=I[1],Y=Object(n.useState)(!1),G=Object(r.a)(Y,2),$=G[0],ee=G[1],te=Object(n.useState)(!1),ae=Object(r.a)(te,2),ne=ae[0],oe=ae[1],ce=Object(n.useState)(!1),le=Object(r.a)(ce,2),ie=le[0],re=le[1],se=Object(n.useState)(!1),ue=Object(r.a)(se,2),de=ue[0],me=ue[1],pe=Object(n.useState)(!1),fe=Object(r.a)(pe,2),be=fe[0],ge=fe[1],ve=W._id,he=W.title,_e=W.photo,ye=W.link,Ee=W.problem,je=W.solution,Oe=W.votes,xe=W.createdBy,we=W.date,Ne=W.reply,ke=w?j.a.text:j.a.textClosed,Te=1===Oe.length?s["post.voter"]:s["post.voters"],Re=Object(d.a)(t,p,e.post.category),Se={more:s["post.show-more"],less:s["post.show-less"]},Le=Oe.includes(e.location._id),De=xe===e.location._id,Me="muni"===e.location.type,Ce=[].concat(i(W.reply.up),i(W.reply.down)).includes(e.location._id),Be=function(){Z(!Q)},Pe=function(){oe(!ne)},He=function(){ee(!$)},Ae=function(){re(!ie)},Je=function(){me(!de)},Ue=function(){ge(!be)},qe=function(){H&&e.updatePost({_id:ve,fields:{reply:{text:H,date:new Date}}}),V(!1)},Ve=function(){C(!M);var t="/post/".concat(ve,"/vote?user=").concat(e.location._id);u()({method:"patch",url:t}).then(function(t){X(Object(l.a)({},W,{votes:[].concat(i(W.votes),[e.location._id])})),e.getPosts(e.location.location)}).catch(function(e){return console.log(e)})},Fe=s["post.age"],Ke=o.a.createElement(h.g,{date:we,daysText:Fe,direction:c,votes:Oe.length,voterText:Te}),We=M?o.a.createElement(h.d,{close:Ve,text:s["vote.thanks"]}):null,Xe=Le||De||Me?null:o.a.createElement("div",{className:j.a.voteButton,onClick:function(){return Ve()}},o.a.createElement(b.a,null));Oe.includes(e.location._id)&&(Xe=o.a.createElement(h.m,{text:s["post.voted"],direction:c}));var ze,Ie,Qe="",Ze="";if(ze=Me&&!Ne?o.a.createElement(h.f,{action:function(){V(!q)}}):null,Ne){var Ye=function(e,t){var a=e.up.length,n=e.down.length,o="secondary";return a<n&&(o="attention"),a===n&&(o="white"),{replyCardStyle:function(e,t,a){var n=e+t[0].toUpperCase()+t.slice(1);return a&&(n=n+a[0].toUpperCase()+a.slice(1)),n}("card",o,t?"open":"closed"),replyCardColor:o}}(Ne,R),Ge=Ye.replyCardStyle,$e=Ye.replyCardColor;Ne.text&&!Ce?Ze=o.a.createElement(h.j,{fill:$e,onClick:function(t){console.log(t);var a=Ne.up,n=Ne.down;t?a.push(e.location._id):n.push(e.location._id);var o="/post/".concat(ve,"/reply/vote?user=").concat(e.location._id,"&vote=").concat(t);u()({method:"get",url:o}).then(function(t){X(Object(l.a)({},W,{reply:Object(l.a)({},W.reply,{up:a,down:n})})),e.getPosts(e.location.location)}).catch(function(e){return console.log(e)})}}):Ce&&(Ze=o.a.createElement(h.m,{text:s["post.voted"],direction:c}));var et=o.a.createElement(h.i,{replies:{up:Ne.up,down:Ne.down}}),tt=null,at=null,nt=null;Me&&(tt=ie?o.a.createElement("div",{className:j.a[Object(O.a)("replyEditButtons",c)]},o.a.createElement(x.a,{mode:"secondary",title:s["muni-reply.edit"],action:Ue}),o.a.createElement(x.a,{mode:"attention",title:s["muni-reply.delete"],actionMessage:Je})):null,at=de?o.a.createElement(h.c,{close:Je,action:function(t){if(console.log(t),"primary"===t){var a=Object(l.a)({},W,{reply:{text:"",date:new Date,up:[],down:[]}}),n="/post/".concat(ve);u.a.patch(n,{post:JSON.stringify(a)}).then(function(t){Ue(),e.getPosts(e.location.location)}).catch(function(e){console.log(e)})}},text:s["muni-reply.delete.text"]}):null,nt=be?o.a.createElement(h.c,{close:Ue,action:function(t){if(console.log(t),"primary"===t){var a=Object(l.a)({},W,{reply:{text:H,date:new Date,up:[],down:[]}}),n="/post/".concat(ve);u.a.patch(n,{post:JSON.stringify(a)}).then(function(t){Ue(),e.getPosts(e.location.location)}).catch(function(e){console.log(e)})}},text:s["muni-reply.edit.text"]},o.a.createElement("div",{className:"section"},o.a.createElement("input",{autoFocus:!0,type:"text",name:"reply",value:H,onChange:function(e){return function(e){A(e.target.value)}(e)},placeholder:s["muni.post.prompt.text"],required:!0}))):null),Qe=Ne.text?o.a.createElement("div",{className:j.a[Ge]},o.a.createElement("div",{className:j.a[Object(O.a)("replyTitleLine",c)]},et,o.a.createElement("span",{className:j.a.replyCardTitle},s["munireply.title"])),o.a.createElement("div",{className:j.a.replyMessage},H),Ne.text.length>50?o.a.createElement(h.k,{color:"white"===$e?"primary":"white",title:Se,direction:c,opened:R,action:S}):null,tt,at,nt):null,Me&&(Ze=null)}var ot=$?o.a.createElement(h.a,{text:s["post.delete.confirm"],close:He,action:function(t){"secondary"===t&&(e.deletePost(ve),e.getPosts(e.location.location),e.setModule("home"))},direction:c}):null;Ie=q?o.a.createElement(v.a,{disabled:!0,close:qe},o.a.createElement(h.e,{label:s["newreply.label"],value:H,placeholder:s["newreply.placeholder"],action:function(e){switch(e.target.name){case"replyText":A(e.target.value)}},direction:c,submit:qe,submitText:s["login.button.submit"]})):null;var ct=ne?o.a.createElement("div",null,o.a.createElement(h.a,{text:s["post.update.confirm"],close:Pe,action:function(t){if(console.log(t),"attention"===t)Be(),X(e.post),Pe();else{var a="/post/".concat(ve);u.a.patch(a,{post:JSON.stringify(W)}).then(function(t){Be(),e.getPosts(e.location.location)}).catch(function(e){console.log(e)})}},direction:c})):null,lt=Q?o.a.createElement("div",{className:j.a.deleteButton},o.a.createElement(x.a,{mode:"attention",action:He},s["post.delete.button"])):null,it=De||Me?{right:{icon:Object(m.i)(Me?"secondary":"primary"),action:Me?Ae:Be,noRtl:!0}}:null;(Q||ie)&&(it={right:{icon:Object(m.g)(ie?"secondary":"primary"),action:ie?Ae:Pe,noRtl:!0}});var rt=Object(l.a)({name:e.location.name[e.language.short]},it,{left:{icon:Object(m.f)(Me?"secondary":"primary"),action:function(){e.setModule(e.prevModule)}}});return o.a.createElement(y.a,{header:!0},o.a.createElement(g.a,rt),o.a.createElement("div",{className:j.a.wrapper},o.a.createElement("div",{"data-testid":"post__view",id:ve,className:j.a.post},o.a.createElement(h.l,{category:Re,title:he,numbersLine:Ke}),o.a.createElement(h.h,{src:_e,edit:Q,actions:{set:function(e){X(Object(l.a)({},W,{photo:e}))},remove:function(){X(Object(l.a)({},W,{photo:""}))}}}),o.a.createElement(h.b,{primary:!0,text:ye,direction:c,edit:Q,actions:{set:function(e){X(Object(l.a)({},W,{link:e}))},remove:function(){X(Object(l.a)({},W,{link:""}))}},editText:{message:s["post.link.edit"],confirm:s.confirm,cancel:s.cancel,label:s["new.field.link.label"],placeholder:s["new.field.link.prompt"]}}),o.a.createElement("div",{className:ke},o.a.createElement(_.a,{step:!0,title:s["post.problem"],text:Ee,direction:c}),o.a.createElement(_.a,{back:!0,title:s["post.solution"],text:je,direction:c})),o.a.createElement(h.k,{color:"primary",title:Se,direction:c,opened:w,action:N})),o.a.createElement("div",{className:j.a.voted},Xe),We,ze,Ie,Qe,Ne.text?o.a.createElement("div",{className:j.a.replyVoted},Ze):null,lt,ot,ct))}),N=a(119),k=Object(c.b)(function(e){return{language:e.language,location:e.locationData,prevModule:e.prevModule,post:e.news.filter(function(t){return t._id===e.post._id})[0]}},{setModule:p.l,getMuniPosts:p.c})(function(e){var t=e.language,a=t.direction,c=t.text,i=Object(n.useState)(e.post),s=Object(r.a)(i,2),d=s[0],p=s[1],f=Object(n.useState)(!1),b=Object(r.a)(f,2),v=b[0],E=b[1],O=Object(n.useState)(!1),w=Object(r.a)(O,2),k=w[0],T=w[1],R=Object(n.useState)(!1),S=Object(r.a)(R,2),L=S[0],D=S[1],M=d._id,C=d.title,B=(d.photo,d.link,d.problem,d.votes,d.createdBy,d.date,d.reply,function(){D(!L)}),P=function(){E(!v)},H=function(){T(!k)},A=L?o.a.createElement("div",{className:j.a.deleteButton},o.a.createElement(x.a,{mode:"attention",action:P},c["post.delete.button"])):null,J=k?o.a.createElement("div",null,o.a.createElement(h.a,{text:c["post.update.confirm"],close:H,action:function(t){if(console.log(t),"attention"===t)B(),p(e.post),H();else{var a="/muni/".concat(e.location.location);u.a.patch(a,{post:JSON.stringify(d)}).then(function(t){B(),e.getMuniPosts(e.location.location)}).catch(function(e){console.log(e)})}},direction:a})):null,U=v?o.a.createElement(h.a,{text:c["post.delete.confirm"],close:P,action:function(t){if("secondary"===t){var a="/muni/".concat(e.location.location);u.a.put(a,{post:M}).then(function(t){B(),e.getMuniPosts(e.location.location)}).catch(function(e){console.log(e)})}},direction:a}):null,q={right:{icon:Object(m.i)("secondary"),action:B,noRtl:!0}};L&&(q={right:{icon:Object(m.g)("secondary"),action:H,noRtl:!0}});var V=Object(l.a)({name:e.location.name[e.language.short]},q,{left:{icon:Object(m.f)("secondary"),action:function(){e.setModule(e.prevModule)}}});return o.a.createElement(y.a,{header:!0},o.a.createElement(g.a,V),o.a.createElement("div",{className:j.a.wrapper},o.a.createElement("div",{"data-testid":"post__view",id:d._id,className:j.a.post},o.a.createElement(h.l,{muni:!0,title:C}),o.a.createElement(h.h,{src:d.photo,edit:L,actions:{set:function(e){p(Object(l.a)({},d,{photo:e}))},remove:function(){p(Object(l.a)({},d,{photo:""}))}}}),o.a.createElement(N.a,null,o.a.createElement(h.b,{primary:!0,text:d.link,direction:a,edit:L,actions:{set:function(e){p(Object(l.a)({},d,{link:e}))},remove:function(){p(Object(l.a)({},d,{link:""}))}},editText:{message:c["post.link.edit"],confirm:c.confirm,cancel:c.cancel,label:c["new.field.link.label"],placeholder:c["new.field.link.prompt"]}})),o.a.createElement(_.a,{muni:!0,text:d.text,direction:a,edit:L,action:function(e){p(Object(l.a)({},d,{text:e}))}}))),A,U,J)}),T=a(36);t.default=Object(c.b)(function(e){return{muni:"muni"===e.post.type}},{})(function(e){var t=e.muni?o.a.createElement(k,null):o.a.createElement(w,null);return o.a.createElement(T.a,null,t)})},87:function(e,t,a){"use strict";var n=a(12),o=a(10),c=a(27),l=a(16),i=a(0),r=a.n(i),s=a(88),u=a.n(s),d=function(e){return r.a.createElement("h1",{className:"rtl"===e.direction?u.a.titleR:u.a.title},e.title)},m=a(7),p=a(89),f=a.n(p),b=a(90),g=a.n(b),v=Object(m.b)(function(e){return{language:e.language,type:e.type}},{})(function(e){var t=e.language,a=t.direction,n=t.text,i=g.a[Object(o.a)("header",a)],s=g.a[Object(o.a)("headerDesc",a)],u=g.a[Object(o.a)("title",a)];return r.a.createElement("div",{className:g.a.content},r.a.createElement("section",{className:i},r.a.createElement(c.a,{mode:"minimal",action:e.cancel},Object(l.j)("white")),r.a.createElement("div",{className:u},n["help.mycity"]),r.a.createElement(c.a,{mode:"minimal"})),r.a.createElement("section",{className:s},r.a.createElement("div",null,n["help.button.help"])),r.a.createElement("section",{className:g.a.pinned},r.a.createElement("div",null,n["help.post.pinned"])),r.a.createElement("section",{className:g.a.card},r.a.createElement("div",{className:g.a.photo},n["help.post.photo"]),r.a.createElement("div",{className:g.a.category},n["help.post.category"]),r.a.createElement("div",{className:g.a.title},n["help.post.title"]),r.a.createElement("div",{className:g.a.lineThree},n["help.post.age"])),r.a.createElement("section",null,r.a.createElement("div",{className:g.a.voteButtonText},n["muni"===e.type?"help.new.muni":"help.new"])),r.a.createElement("section",null,r.a.createElement("div",{className:g.a.navLeft},n["help.navigation"]),r.a.createElement("div",{className:g.a.navRight},n["help.navigation"])))}),h=Object(m.b)(function(e){return{module:e.module,language:e.language}},{})(function(e){var t=e.language.direction,a=Object(o.a)("help-content",t),n=r.a.createElement("div",{className:a});switch(e.module){case"post":break;case"home":n=r.a.createElement(v,{cancel:e.showHelp})}return r.a.createElement("div",{onClick:function(){return e.showHelp()},className:"help"},n)});t.a=Object(m.b)(function(e){return{language:e.language,type:e.type}},{})(function(e){var t=r.a.useState(!1),a=Object(n.a)(t,2),i=a[0],s=a[1],u=e.language.direction,m=e.name,p=function(e,t){var a=t?f.a.icon:f.a[Object(o.a)("icon",u)];return r.a.createElement("div",{className:a},e)},b=function(){s(!i)},g=e.left?p(e.left.icon,e.left.noRtl):p(Object(l.j)("muni"===e.type?"secondary":"primary"),!0),v=e.right?p(e.right.icon,e.right.noRtl):r.a.createElement("div",null);return r.a.createElement("header",{className:f.a[Object(o.a)("plank",u)]},r.a.createElement(c.a,{mode:"minimal",action:function(){e.left?e.left.action():b()}},g),r.a.createElement(d,{title:m,direction:u}),r.a.createElement(c.a,{mode:"minimal",action:function(){e.right&&e.right.action()}},v),i?r.a.createElement(h,{showHelp:b}):null)})},88:function(e,t,a){e.exports={title:"Title_title__3-ab1",titleR:"Title_titleR__1AdDW"}},89:function(e,t,a){e.exports={plank:"Header_plank__1Xkcj",plankRTL:"Header_plankRTL__22swp",icon:"Header_icon__1KqqL",iconRTL:"Header_iconRTL__2ufUE"}},90:function(e,t,a){e.exports={content:"style_content__2T40g",central:"style_central__ADLjj",header:"style_header__tQ9Sx",headerRTL:"style_headerRTL__2kFRT",icon:"style_icon__1YFTz",iconRTL:"style_iconRTL__3HH5-",title:"style_title__1WHmK",titleRTL:"style_titleRTL__vpycB",headerDesc:"style_headerDesc__3ANCb",headerDescRTL:"style_headerDescRTL__3knRN",pinned:"style_pinned__Kl-fS",card:"style_card__1D5C-",photo:"style_photo__2fnix",category:"style_category__24IMX",lineThree:"style_lineThree__NkwpN",voteButtonText:"style_voteButtonText__2_n0m",navLeft:"style_navLeft__bzWVA",navRight:"style_navRight__k7-Uq"}},96:function(e,t,a){"use strict";var n=a(0),o=a.n(n),c=a(7),l=a(97),i=a.n(l);t.a=Object(c.b)(function(e){return{language:e.language}},{})(function(e){var t=e.language.text;return o.a.createElement("button",{className:i.a.vote},o.a.createElement("div",{className:i.a.inner},o.a.createElement("span",null,t["card.button.vote"])))})},97:function(e,t,a){e.exports={vote:"VoteButton_vote__lXrZs",inner:"VoteButton_inner__2gQwD"}}}]);
//# sourceMappingURL=5.7d2482d5.chunk.js.map