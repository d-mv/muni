(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{101:function(e,t,a){"use strict";var n=a(13),l=a(31),o=a(18),c=a(0),i=a.n(c),r=a(102),s=a.n(r),u=function(e){return i.a.createElement("h1",{className:"rtl"===e.direction?s.a.titleR:s.a.title},e.title)},d=a(8),p=a(103),m=a.n(p),h=a(6),b=a(104),v=a.n(b),f=Object(d.b)(function(e){return{language:e.language,type:e.type}},{})(function(e){var t=e.language,a=t.direction,c=t.text,r=v.a[Object(n.a)("header",a)],s=v.a[Object(n.a)("headerDesc",a)],u=v.a[Object(n.a)("title",a)];return i.a.createElement("div",{className:v.a.content},i.a.createElement("section",{className:r},i.a.createElement(l.a,{mode:"minimal",action:e.cancel},Object(o.j)("white")),i.a.createElement("div",{className:u},c["help.mycity"]),i.a.createElement(l.a,{mode:"minimal"})),i.a.createElement("section",{className:s},i.a.createElement("div",null,c["help.button.help"])),i.a.createElement("section",{className:v.a.pinned},i.a.createElement("div",null,c["help.post.pinned"])),i.a.createElement("section",{className:v.a.card},i.a.createElement("div",{className:v.a.photo},c["help.post.photo"]),i.a.createElement("div",{className:v.a.category},c["help.post.category"]),i.a.createElement("div",{className:v.a.title},c["help.post.title"]),i.a.createElement("div",{className:v.a.lineThree},c["help.post.age"])),i.a.createElement("section",null,i.a.createElement("div",{className:v.a.voteButtonText},c["muni"===e.type?"help.new.muni":"help.new"])),i.a.createElement("section",null,i.a.createElement("div",{className:v.a.navLeft},c["help.navigation"]),i.a.createElement("div",{className:v.a.navRight},c["help.navigation"])))}),_=Object(d.b)(function(e){return{module:e.module,language:e.language,help:e.help}},{showHelp:h.showHelp})(function(e){var t=e.language.direction,a=Object(n.a)("help-content",t),l=function(){e.showHelp(!e.help)},o=i.a.createElement("div",{className:a});switch(e.module){case"post":break;case"home":o=i.a.createElement(f,{cancel:l})}return i.a.createElement("div",{onClick:function(){return l()},className:"help"},o)});t.a=Object(d.b)(function(e){return{language:e.language,user:e.auth.user,help:e.help}},{showHelp:h.showHelp})(function(e){var t=e.language.direction,a=e.name,r=e.user,s=function(e,a){var l=a?m.a.icon:m.a[Object(n.a)("icon",t)];return i.a.createElement("div",{className:l},e)};Object(c.useEffect)(function(){r.settings.help&&e.showHelp(!0)},[]);var d=e.left?s(e.left.icon,e.left.noRtl):s(Object(o.j)("muni"===e.user.type?"secondary":"primary"),!0),p=e.right?s(e.right.icon,e.right.noRtl):i.a.createElement("div",null);return i.a.createElement("header",{className:m.a[Object(n.a)("plank",t)]},i.a.createElement(l.a,{mode:"minimal",action:function(){e.left?e.left.action():e.showHelp(!e.help)}},d),i.a.createElement(u,{title:a,direction:t}),i.a.createElement(l.a,{mode:"minimal",action:function(){e.right&&e.right.action()}},p),e.help?i.a.createElement(_,null):null)})},102:function(e,t,a){e.exports={title:"Title_title__3-ab1",titleR:"Title_titleR__1AdDW"}},103:function(e,t,a){e.exports={plank:"Header_plank__1Xkcj",plankRTL:"Header_plankRTL__22swp",icon:"Header_icon__1KqqL",iconRTL:"Header_iconRTL__2ufUE"}},104:function(e,t,a){e.exports={content:"style_content__2T40g",central:"style_central__ADLjj",header:"style_header__tQ9Sx",headerRTL:"style_headerRTL__2kFRT",icon:"style_icon__1YFTz",iconRTL:"style_iconRTL__3HH5-",title:"style_title__1WHmK",titleRTL:"style_titleRTL__vpycB",headerDesc:"style_headerDesc__3ANCb",headerDescRTL:"style_headerDescRTL__3knRN",pinned:"style_pinned__Kl-fS",card:"style_card__1D5C-",photo:"style_photo__2fnix",category:"style_category__24IMX",lineThree:"style_lineThree__NkwpN",voteButtonText:"style_voteButtonText__2_n0m",navLeft:"style_navLeft__bzWVA",navRight:"style_navRight__k7-Uq"}},109:function(e,t,a){"use strict";var n=a(0),l=a.n(n),o=a(8),c=a(110),i=a.n(c);t.a=Object(o.b)(function(e){return{language:e.language}},{})(function(e){var t=e.language.text;return l.a.createElement("button",{className:i.a.vote},l.a.createElement("div",{className:i.a.inner},l.a.createElement("span",null,t["card.button.vote"])))})},110:function(e,t,a){e.exports={vote:"VoteButton_vote__lXrZs",inner:"VoteButton_inner__2gQwD"}},134:function(e,t,a){"use strict";var n=a(0),l=a.n(n),o=a(135),c=a.n(o);t.a=function(e){var t=c.a.block;return e.border?t=c.a.border:e.rectangle&&(t=c.a.borderRectangle),l.a.createElement("div",{className:t},e.children)}},135:function(e,t,a){e.exports={block:"Block_block__25D3U",border:"Block_border__3jZ4R",borderRectangle:"Block_borderRectangle__bDkgw"}},169:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(4),c=a(60),i=a(19),r=a(8),s=a(106),u=a(18),d=a(6),p=a(15),m=a(109),h=a(101),b=a(126),v=a(128),f=a(123),_=a(132),y=a.n(_),g=a(13),E=a(31),j=a(9),O=a(7),w=Object(r.b)(function(e){return{language:e.language,locations:e.locations,posts:e.posts,post:e.post,mode:e.mode,prevModule:e.prevModule,token:e.token,auth:e.auth,categories:e.categories}},{vote:d.vote,updatePost:p.j,setModule:d.setModule,fetchData:d.fetchData,getPosts:p.e,deletePost:p.c,showPost:p.h,votePost:p.k})(function(e){var t=e.categories,a=e.auth,r=e.locations,d=e.post,p=a.user,_=e.language,w=_.direction,x=_.text,N=_.short,k=Object(n.useState)(!1),T=Object(i.a)(k,2),R=T[0],P=T[1],L=Object(n.useState)(!1),S=Object(i.a)(L,2),C=S[0],M=S[1],D=Object(n.useState)(!1),B=Object(i.a)(D,2),H=B[0],A=B[1],U=Object(n.useState)(!1),V=Object(i.a)(U,2),q=V[0],F=V[1],K=e.posts.filter(function(t){return t._id===e.post._id})[0],W=Object(n.useState)(!1),X=Object(i.a)(W,2),z=X[0],J=X[1],Q=Object(n.useState)(!1),Z=Object(i.a)(Q,2),I=Z[0],Y=Z[1],G=Object(n.useState)(!1),$=Object(i.a)(G,2),ee=$[0],te=$[1],ae=Object(n.useState)(!1),ne=Object(i.a)(ae,2),le=ne[0],oe=ne[1],ce=Object(n.useState)(!1),ie=Object(i.a)(ce,2),re=ie[0],se=ie[1],ue=Object(n.useState)(!1),de=Object(i.a)(ue,2),pe=de[0],me=de[1],he=r.filter(function(e){return e._id===p.location})[0],be=R?y.a.text:y.a.textClosed,ve=1===d.votes.length?x["post.voter"]:x["post.voters"],fe=Object(s.a)(t,N,d.category),_e={more:x["post.show-more"],less:x["post.show-less"]},ye=d.votes.includes(e.auth.user._id),ge=d.createdBy===e.auth.user._id,Ee="muni"===a.user.type;Object(n.useEffect)(function(){console.log("posts changed"),e.showPost(e.posts.filter(function(t){return t._id===e.post._id})[0])},[e.posts]);var je=!1;d.reply.up||d.reply.down?d.reply.up.length>0&&d.reply.down.length>0?je=[].concat(Object(c.a)(d.reply.up),Object(c.a)(d.reply.down)).includes(e.auth.user._id):d.reply.up.length>0?je=d.reply.up.includes(e.auth.user._id):d.reply.down.length>0&&(je=d.reply.down.includes(e.auth.user._id)):je=!0;var Oe=function(){F(!q)},we=function(){te(!ee)},xe=function(){Y(!I)},Ne=function(){oe(!le)},ke=function(){se(!re)},Te=function(){me(!pe)},Re=function(t){e.showPost({reply:{text:t.target.value}})},Pe=function(t){Object(O.a)({text:"submitUpdatePost:",emph:t||"",type:"positive"}),me(!1),oe(!1),F(!1),t?(J(!1),te(!1),"attention"===t?e.showPost(K):e.updatePost(d)):e.updatePost(d)},Le=function(){A(!H),setTimeout(function(){A(!H)},2e3),e.votePost(d._id)},Se=function(t){console.log("object"),Object(O.a)({text:"handleReplyVoting:",emph:t.toString(),type:"positive"});var a=d.reply.up,n=d.reply.down;t?a.push(e.auth.user._id):n.push(e.auth.user._id);var l=Object(o.a)({},d.reply,{reply:Object(o.a)({},d.reply,{up:a,down:n})});e.updatePost(Object(o.a)({},d,{reply:l}))},Ce=x["post.age"],Me=l.a.createElement(v.g,{date:d.createdAt,daysText:Ce,direction:w,votes:d.votes.length,voterText:ve}),De=H?l.a.createElement(v.d,{close:Le,text:x["vote.thanks"]}):null,Be=ye||ge||Ee?null:l.a.createElement("div",{className:y.a.voteButton,onClick:function(){return Le()}},l.a.createElement(m.a,null));d.votes.includes(e.auth.user._id)&&(Be=l.a.createElement(v.l,{text:x["post.voted"],direction:w}));var He,Ae="",Ue="",Ve=Ee&&!d.reply.text?l.a.createElement(v.f,{action:Oe}):null;if(d.reply){var qe=function(e,t){var a=e.up?e.up.length:0,n=e.down?e.down.length:0,l="secondary";return a<n&&(l="attention"),a===n&&(l="white"),{replyCardStyle:function(e,t,a){var n=e+t[0].toUpperCase()+t.slice(1);return a&&(n=n+a[0].toUpperCase()+a.slice(1)),n}("card",l,t?"open":"closed"),replyCardColor:l}}(d.reply,C),Fe=qe.replyCardStyle,Ke=qe.replyCardColor;d.reply.text&&!je?Ue=l.a.createElement("div",{className:y.a[Object(g.a)("thumbsContainer",w)]},l.a.createElement("div",{onClick:function(e){return Se(!0)}},"\u2b06"),l.a.createElement("div",{onClick:function(e){return Se(!1)}},"\u2b07")):je&&(Ue=l.a.createElement(v.l,{text:x["post.voted"],direction:w}));var We=l.a.createElement(v.i,{replies:{up:d.reply.up,down:d.reply.down}}),Xe=null,ze=null,Je=null;Ee&&(Xe=le?l.a.createElement("div",{className:y.a[Object(g.a)("replyEditButtons",w)]},l.a.createElement(E.a,{mode:"secondary",title:x["muni-reply.edit"],action:Te}),l.a.createElement(E.a,{mode:"attention",title:x["muni-reply.delete"],actionMessage:ke})):null,ze=re?l.a.createElement(v.c,{close:ke,action:function(t){if(Object(O.a)({text:"submitDeletePost:",emph:t,type:"positive"}),"primary"===t){var a=Object(o.a)({},d,{reply:{}});e.showPost(a),e.updatePost(a)}oe(!1)},text:x["muni-reply.delete.text"]}):null,Je=pe?l.a.createElement(v.c,{close:Te,action:Pe,text:x["muni-reply.edit.text"]},l.a.createElement("div",{className:"section"},l.a.createElement("input",{autoFocus:!0,type:"text",name:"reply",value:d.reply.text,onChange:function(e){return Re(e)},placeholder:x["muni.post.prompt.text"],required:!0}))):null),Ae=d.reply.text?l.a.createElement("div",{className:y.a[Fe]},l.a.createElement("div",{className:y.a[Object(g.a)("replyTitleLine",w)]},We,l.a.createElement("span",{className:y.a.replyCardTitle},x["munireply.title"])),l.a.createElement("div",{className:y.a.replyMessage},d.reply.text),d.reply.text.length>50?l.a.createElement(v.j,{color:"white"===Ke?"primary":"white",title:_e,direction:w,opened:C,action:M}):null,Xe,ze,Je):null,Ee&&(Ue=null)}var Qe=I?l.a.createElement(v.a,{text:x["post.delete.confirm"],close:xe,action:function(t){Object(O.a)({text:"submitDeletePost:",emph:t,type:"positive"}),"secondary"===t&&(e.deletePost(d._id),e.setModule(e.prevModule))},direction:w}):null;He=q?l.a.createElement(b.a,{disabled:!0,close:Oe},l.a.createElement(v.e,{label:x["newreply.label"],value:d.reply.text,placeholder:x["newreply.placeholder"],action:Re,direction:w,submit:Pe,submitText:x["login.button.submit"]})):null;var Ze=ee?l.a.createElement("div",null,l.a.createElement(v.a,{text:x["post.update.confirm"],close:we,action:Pe,direction:w})):null,Ie=z?l.a.createElement("div",{className:y.a.deleteButton},l.a.createElement(E.a,{mode:"attention",action:xe},x["post.delete.button"])):null,Ye=ge||Ee?{right:{icon:Object(u.i)(Ee?"secondary":"primary"),action:Ee?Ne:function(){J(!z)},noRtl:!0}}:null;(z||le)&&(Ye={right:{icon:Object(u.g)(le?"secondary":"primary"),action:le?Ne:we,noRtl:!0}});var Ge=Object(o.a)({name:he.name[p.settings.language]},Ye,{left:{icon:Object(u.f)(Ee?"secondary":"primary"),action:function(){e.showPost(Object(o.a)({show:!1},j.b)),e.setModule(e.prevModule)}}});return l.a.createElement("div",{className:y.a.container},l.a.createElement(h.a,Ge),l.a.createElement("div",{className:y.a.wrapper},l.a.createElement("div",{"data-testid":"post__view",id:d._id,className:y.a.post},l.a.createElement(v.k,{category:fe,title:d.title,numbersLine:Me}),l.a.createElement(v.h,{src:d.photo,edit:z,actions:{set:function(t){e.showPost({photo:t})},remove:function(){e.showPost({photo:""})}}}),l.a.createElement(v.b,{primary:!0,text:d.link,direction:w,edit:z,actions:{set:function(t){e.showPost({link:t})},remove:function(){e.showPost({link:""})}},editText:{message:x["post.link.edit"],confirm:x.confirm,cancel:x.cancel,label:x["new.field.link.label"],placeholder:x["new.field.link.prompt"]}}),l.a.createElement("div",{className:be},l.a.createElement(f.a,{step:!0,title:x["post.problem"],text:d.problem,direction:w}),l.a.createElement(f.a,{back:!0,title:x["post.solution"],text:d.solution,direction:w})),l.a.createElement(v.j,{color:"primary",title:_e,direction:w,opened:R,action:P})),l.a.createElement("div",{className:y.a.voted},Be),De,Ve,He,Ae,d.reply.text?l.a.createElement("div",{className:y.a.replyVoted},Ue):null,Ie,Qe,Ze))}),x=a(10),N=a.n(x),k=a(134),T=a(100),R=Object(r.b)(function(e){return{auth:e.auth,language:e.language,locations:e.locations,prevModule:e.prevModule,post:e.news.filter(function(t){return t._id===e.post._id})[0]}},{setModule:d.setModule,getNews:p.d})(function(e){var t=e.language,a=t.direction,c=t.text,r=e.auth.user,s=e.locations.filter(function(e){return e._id===r.location})[0],d=Object(n.useState)(e.post),p=Object(i.a)(d,2),m=p[0],b=p[1],_=Object(n.useState)(!1),g=Object(i.a)(_,2),j=g[0],O=g[1],w=Object(n.useState)(!1),x=Object(i.a)(w,2),R=x[0],P=x[1],L=Object(n.useState)(!1),S=Object(i.a)(L,2),C=S[0],M=S[1],D="muni"===r.type;console.log(m.title);var B=function(){M(!C)},H=function(){O(!j)},A=function(){P(!R)},U=C?l.a.createElement("div",{className:y.a.deleteButton},l.a.createElement(E.a,{mode:"attention",action:H},c["post.delete.button"])):null,V=R?l.a.createElement("div",null,l.a.createElement(v.a,{text:c["post.update.confirm"],close:A,action:function(t){if("attention"===t)B(),b(e.post),A();else{var a="/muni/".concat(r.location);N.a.patch(a,Object(o.a)({},m)).then(function(t){B(),e.getNews(r.location)}).catch(function(e){console.log(e)})}},direction:a})):null,q=j?l.a.createElement(v.a,{text:c["post.delete.confirm"],close:H,action:function(t){if("secondary"===t){var a="/muni/".concat(r.location);N.a.put(a,{post:m._id}).then(function(t){B(),e.getNews(r.location)}).catch(function(e){console.log(e)})}},direction:a}):null,F=c["post.age"],K=l.a.createElement(v.g,{date:m.createdAt,daysText:F,direction:a}),W=D?{right:{icon:Object(u.i)("secondary"),action:B,noRtl:!0}}:null;C&&(W={right:{icon:Object(u.g)("secondary"),action:A,noRtl:!0}});var X=Object(o.a)({name:s.name[r.settings.language]},W,{left:{icon:Object(u.f)(D?"secondary":"primary"),action:function(){e.setModule(e.prevModule)}}});return console.log(s),l.a.createElement(T.a,{header:!0},l.a.createElement(h.a,X),l.a.createElement("div",{className:y.a.wrapper},l.a.createElement("div",{"data-testid":"post__view",id:m._id,className:y.a.post},l.a.createElement(v.k,{muni:!0,title:m.title,numbersLine:K}),l.a.createElement(v.h,{src:m.photo,edit:C,actions:{set:function(e){b(Object(o.a)({},m,{photo:e}))},remove:function(){b(Object(o.a)({},m,{photo:""}))}}}),l.a.createElement(k.a,null,l.a.createElement(v.b,{primary:!0,text:m.link,direction:a,edit:C,actions:{set:function(e){b(Object(o.a)({},m,{link:e}))},remove:function(){b(Object(o.a)({},m,{link:""}))}},editText:{message:c["post.link.edit"],confirm:c.confirm,cancel:c.cancel,label:c["new.field.link.label"],placeholder:c["new.field.link.prompt"]}})),l.a.createElement(f.a,{muni:!0,text:m.text,direction:a,edit:C,action:function(e){b(Object(o.a)({},m,{text:e}))}}))),U,q,V)}),P=a(40);t.default=function(e){return l.a.createElement(P.a,null,e.news?l.a.createElement(R,null):l.a.createElement(w,null))}}}]);
//# sourceMappingURL=8.95ffb26e.chunk.js.map